name: Deploy to Firebase Function

on:
  push:
    branches:
    - main

jobs:
  main:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@master
    - name: Create Service Account key
      run: echo '${{ secrets.FIREBASE_SERVICE_ACCOUNT }}' > $HOME/gcloud.json
    - name: Export Service Account  
      run: export GOOGLE_APPLICATION_CREDENTIALS=$HOME/gcloud.json
    - name: Deploy Cloud Functions
      run: npx firebase-tools deploy --only functions --json
